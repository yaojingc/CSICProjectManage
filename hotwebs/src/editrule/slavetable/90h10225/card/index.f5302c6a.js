!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react"],t):"object"==typeof exports?exports["editrule/slavetable/90h10225/card/index"]=t(require("nc-lightapp-front"),require("react")):e["editrule/slavetable/90h10225/card/index"]=t(e["nc-lightapp-front"],e.React)}(window,function(e,t){return function(e){var t={};function a(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(r,o,function(t){return e[t]}.bind(null,o));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=196)}({0:function(t,a){t.exports=e},1:function(e,a){e.exports=t},106:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,n,d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},l=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),c=a(1),i=(n=c)&&n.__esModule?n:{default:n},s=a(0),u=a(107),f=a(108),b=a(109),_=a(110),C=a(111),R=a(112),p=a(37),T=a(6),A=a(39),m=a(36);var v=s.base.NCAffix,D=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.call(a),a.state={json:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.Component),l(t,[{key:"componentWillMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:T.MULTILANG.moduleId,domainName:T.MULTILANG.domainName,callback:function(t,a,r){a&&((0,u.initTemplate)(e.props,t),e.setState({json:t,inlt:r}))}}),window.onbeforeunload=function(){if("edit"==e.props.cardTable.getStatus(T.CARD.table_code))return e.state.json["90H10225-000007"]}}},{key:"componentDidMount",value:function(){var e=this.props.getUrlParam("status"),t=this.props.getUrlParam("id");"add"===e?(0,A.cardCreate)(this.props):t&&(0,A.getCardData)(this.props,t)}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.cardPagination,r=e.BillHeadInfo,o=e.cardTable,n=a.createCardPagination,l=t.createForm,c=o.createCardTable,s=r.createBillHeadInfo,u=this.props.getUrlParam("status"),A=this.props.getUrlParam("id"),m=this.props.form.getFormItemsValue(T.CARD.page_code,T.PRIMARTKEY.bill_no);return i.default.createElement("div",{className:"nc-bill-card"},i.default.createElement("div",{className:"nc-bill-top-area"},i.default.createElement(v,null,i.default.createElement("div",{className:"nc-bill-header-area"},i.default.createElement("div",null,s({title:this.state.json[T.CARD.page_title],billCode:m&&m.value,backBtnClick:f.buttonClick.bind(this,this.props,T.CARD_BUTTON.back)})),i.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:T.CARD.head_btn_code,onButtonClick:this.onButtonClick})),"browse"==u&&A&&i.default.createElement("div",{className:"header-cardPagination-area",style:{float:"right"}},n({dataSource:T.DATASOURCE,pkname:T.PRIMARTKEY.head_id,handlePageInfoChange:this.handlePageInfoChange})))),i.default.createElement("div",{className:"nc-bill-form-area"},l(T.CARD.form_id,{onAfterEvent:C.afterEvent,onBeforeEvent:b.beforeEvent,setVisibleByForm:!0}))),i.default.createElement("div",{className:"nc-bill-bottom-area"},i.default.createElement("div",{className:"nc-bill-table-area"},c(T.CARD.table_code,{tableHead:this.getTableHead.bind(this),showCheck:!0,showIndex:!0,onSelected:p.bodySelectedEvent,onSelectedAll:p.bodySelectedAllEvent,onBeforeEvent:_.beforeTableEvent,onAfterEvent:R.afterTableEvent,modelSave:f.buttonClick.bind(this,d({},this.props,{json:this.state.json}),T.CARD_BUTTON.save,void 0,!0)}))))}}]),t}(),o=function(){var e=this;this.onButtonClick=function(t,a,r){(0,f.buttonClick)(d({},t,{json:e.state.json}),a,r)},this.handlePageInfoChange=function(t,a){(0,A.pageClick)(d({},t,{json:e.state.json}),a)},this.getTableHead=function(){return i.default.createElement("div",{className:"shoulder-definition-area"},i.default.createElement("div",{className:"definition-icons"},e.props.button.createButtonApp({area:T.CARD.shoulder_btn_code,onButtonClick:m.bodyButtonClick,popContainer:document.querySelector(".header-button-area")})))}},r);D=(0,s.createPage)({billinfo:{billtype:"card",pagecode:T.CARD.page_code,headcode:T.CARD.form_id,bodycode:T.CARD.table_code}})(D),t.default=D},107:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTemplate=function(e,t){e.createUIDom({pagecode:r.CARD.pagecode,appcode:r.APPCODE},function(a){if(a){if(a.button){var d=a.button;e.button.setButtons(d)}if(a.template){var l=a.template;l=function(e,t,a){t[r.CARD.form_id].items.map(function(t){"pk_org"===t.attrcode&&(t.queryCondition=function(){return{funcode:e.getSearchParam("c")}})});var n=!0,d=!1,l=void 0;try{for(var c,i=Object.keys(t.gridrelation)[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var s=c.value;t[s].items.push({attrcode:"opr",label:a["90H10225-000006"],itemtype:"customer",fixed:"right",className:"table-opr",visible:!0,width:150,render:function(t,a,n){var d=e.getUrlParam("status"),l=[];return l="browse"===d?[a.expandRowStatus?r.CARD_BUTTON.fold:r.CARD_BUTTON.unfold]:[r.CARD_BUTTON.expand,r.CARD_BUTTON.insertRow,r.CARD_BUTTON.delRow],e.button.createOprationButton(l,{area:r.CARD.body_btn_code,onButtonClick:function(e,r){return(0,o.bodyButtonClick)(e,r,t,a,n)}})}})}}catch(e){d=!0,l=e}finally{try{!n&&i.return&&i.return()}finally{if(d)throw l}}return t}(e,l,t),e.meta.setMeta(l,function(){var t=e.getUrlParam("status");"add"===t&&(e.initMetaByPkorg(),(0,n.buttonVisibilityControl)(e))})}}})};var r=a(6),o=a(36),n=a(38)},108:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonClick=function(e,t,a,d){switch(t){case o.CARD_BUTTON.back:(0,n.cardBack)(e);break;case o.CARD_BUTTON.create:(0,n.cardCreate)(e);break;case o.CARD_BUTTON.save:(0,n.cardSave)(e,d);break;case o.CARD_BUTTON.saveAdd:(0,n.cardSave)(e,d).then(function(t){t&&(0,n.cardCreate)(e)});break;case o.CARD_BUTTON.update:(0,n.cardUpdate)(e);break;case o.CARD_BUTTON.delete:(0,r.promptBox)({color:"warning",title:e.json["90H10225-000000"],content:e.json["90H10225-000001"],beSureBtnClick:function(){(0,n.cardDelete)(e)}});break;case o.CARD_BUTTON.cancel:(0,r.promptBox)({color:"warning",title:e.json["90H10225-000002"],content:e.json["90H10225-000003"],beSureBtnClick:function(){(0,n.cardCancel)(e)}});break;case o.CARD_BUTTON.refresh:(0,n.cardRefresh)(e)}};var r=a(0),o=a(6),n=a(39)},109:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beforeEvent=function(e,t,a,r,o){return!0}},110:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beforeTableEvent=function(e,t,a,r,o,n,d){return!0}},111:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.afterEvent=function(e,t,a,r,o){"pk_org"===a&&(e.resMetaAfterPkorgEdit(),e.button.setButtonDisabled("addRow",!1))}},112:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.afterTableEvent=function(e,t,a,r,o,n,d,l,c){}},196:function(e,t,a){e.exports=a(106)},36:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bodyButtonClick=function(e,t,a,n,d){switch(t){case r.CARD_BUTTON.addRow:e.cardTable.addRow(r.CARD.table_code,void 0,{},!0);break;case r.CARD_BUTTON.deleteRow:var l=e.cardTable.getCheckedRows(r.CARD.table_code),c=l&&l.map(function(e){return e.index});l.length>0&&e.cardTable.delRowsByIndex(r.CARD.table_code,c),(0,o.bodySelectedEvent)(e);break;case r.CARD_BUTTON.expand:e.cardTable.openTabModel(r.CARD.table_code,"edit",n,d);break;case r.CARD_BUTTON.unfold:case r.CARD_BUTTON.fold:e.cardTable.toggleTabRowView(r.CARD.table_code,n);break;case r.CARD_BUTTON.insertRow:e.cardTable.addRow(r.CARD.table_code,d);break;case r.CARD_BUTTON.delRow:e.cardTable.delRowsByIndex(r.CARD.table_code,d),(0,o.bodySelectedEvent)(e)}[r.CARD_BUTTON.unfold,r.CARD_BUTTON.fold].includes(t)||e.cardTable.setStatus(r.CARD.table_code,"edit")};var r=a(6),o=a(37)},37:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bodySelectedEvent=function(e,t,a,n,d){e.cardTable.getCheckedRows(r.CARD.table_code).length>0?e.button.setButtonDisabled(o,!1):e.button.setButtonDisabled(o,!0)},t.bodySelectedAllEvent=function(e,t,a,r){e.button.setButtonDisabled(o,!a)};var r=a(6),o=[r.CARD_BUTTON.deleteRow]},38:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonVisibilityControl=function(e){var t=e.getUrlParam("status"),a=e.getUrlParam("id"),o="browse"===t,n={},d=[],l=[r.CARD_BUTTON.deleteRow],c=[r.CARD_BUTTON.save,r.CARD_BUTTON.saveAdd,r.CARD_BUTTON.cancel,r.CARD_BUTTON.addRow,r.CARD_BUTTON.deleteRow,r.CARD_BUTTON.insertRow,r.CARD_BUTTON.delRow,r.CARD_BUTTON.expand],i=e.button.getButtons().map(function(e){return e.key}),s=[].concat(function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(i),c,[r.CARD_BUTTON.create,r.CARD_BUTTON.update,r.CARD_BUTTON.delete]);if(o)if(a){var u=[r.CARD_BUTTON.refresh,r.CARD_BUTTON.fold,r.CARD_BUTTON.unfold];d=[r.CARD_BUTTON.create,r.CARD_BUTTON.update,r.CARD_BUTTON.delete].concat(u)}else d=[r.CARD_BUTTON.create];else d=c;var f=!0,b=!1,_=void 0;try{for(var C,R=s[Symbol.iterator]();!(f=(C=R.next()).done);f=!0){var p=C.value;n[p]=d.includes(p)}}catch(e){b=!0,_=e}finally{try{!f&&R.return&&R.return()}finally{if(b)throw _}}e.button.setButtonVisible(n),e.button.setButtonDisabled(l,!0),e.cardTable.setStatus(r.CARD.table_code,o?"browse":"edit"),e.form.setFormStatus(r.CARD.form_id,t)};var r=a(6)},39:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cardBack=function(e){e.pushTo(o.REQUESTURL.toList,{})},t.cardCreate=function(e){e.setUrlParam({status:"add"}),e.initMetaByPkorg(),function(e,t){e.form.setFormItemsDisabled(o.CARD.form_id,{pk_org:t}),e.cardTable.setAllCheckboxAble(o.CARD.table_code,!t)}(e,!1),e.button.setButtonDisabled(o.CARD_BUTTON.addRow,!0),_(e),b(e)},t.cardSave=function(e,t){return new Promise(function(a,n){var i=e.form.isCheckNow(o.CARD.form_id)&&e.cardTable.checkTableRequired(o.CARD.table_code);if(i){var s=e.createMasterChildData(o.CARD.page_code,o.CARD.form_id,o.CARD.table_code,"cardTable");e.validateToSave(s,function(){var t=e.getUrlParam("status");(0,r.ajax)({url:o.REQUESTURL.save,data:s,success:function(n){var i=n.success,s=n.data;if(i){(0,r.toast)({color:"success",content:e.json["36660FMC-000004"]}),n.formulamsg&&n.formulamsg instanceof Array&&n.formulamsg.length>0&&e.dealFormulamsg(n.formulamsg);var u=null;n.data&&(n.data.head&&n.data.head[o.CARD.form_id]&&(u=n.data.head[o.CARD.form_id].rows[0].values[o.PRIMARTKEY.head_id].value,e.form.setAllFormValue(d({},o.CARD.form_id,n.data.head[o.CARD.form_id]))),n.data.body&&n.data.body[o.CARD.table_code]&&e.cardTable.setTableData(o.CARD.table_code,n.data.body[o.CARD.table_code])),e.setUrlParam({id:u,status:"browse"}),"add"===t?c(u,s,o.CARD.form_id,o.DATASOURCE):l(o.PRIMARTKEY.head_id,u,s,o.CARD.form_id,o.DATASOURCE),b(e),a(!0)}}})},d({},o.CARD.table_code,"cardTable"))}t&&e.cardTable.closeModel(o.CARD.table_code)})},t.cardUpdate=function(e){e.setUrlParam({status:"edit"}),b(e)},t.cardDelete=function(e){var t=e.form.getFormItemsValue(o.CARD.form_id,o.PRIMARTKEY.head_id).value||e.getUrlParam("id");(0,r.ajax)({url:o.REQUESTURL.delete,data:{pks:[t]},success:function(a){if(a.success){(0,r.toast)({color:"success",content:e.json["90H10225-000005"]});var n=i(t,o.DATASOURCE);s(o.PRIMARTKEY.head_id,t,o.DATASOURCE);var d=n||null;e.setUrlParam({status:"browse",id:d}),n?C(e,n):(_(e),b(e))}}})},t.getCardData=C,t.cardCancel=function(e){var t=e.getUrlParam("id");if(e.setUrlParam({status:"browse"}),t)e.form.cancel(o.CARD.form_id),e.cardTable.resetTableData(o.CARD.table_code),C(e,t);else{var a=f(o.DATASOURCE),r=a||"";e.setUrlParam({id:r}),r?C(e,r):(_(e),b(e))}},t.cardRefresh=function(e){var t=e.getUrlParam("id");C(e,t,!0)},t.pageClick=function(e,t){e.setUrlParam({status:"browse",id:t}),C(e,t)};var r=a(0),o=a(6),n=a(38);function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=r.cardCache.updateCache,c=r.cardCache.addCache,i=r.cardCache.getNextId,s=r.cardCache.deleteCacheById,u=r.cardCache.getCacheById,f=r.cardCache.getCurrentLastId;function b(e){(0,n.buttonVisibilityControl)(e);var t=e.getUrlParam("status");e.BillHeadInfo.setBillHeadInfoVisible({showBackBtn:"browse"===t,showBillCode:"browse"===t,billCode:e.form.getFormItemsValue(o.CARD.form_id,o.PRIMARTKEY.bill_no)&&e.form.getFormItemsValue(o.CARD.form_id,o.PRIMARTKEY.bill_no).value}),"add"!==t&&e.resMetaAfterPkorgEdit()}function _(e){e.form.EmptyAllFormValue(o.CARD.form_id),e.cardTable.setTableData(o.CARD.table_code,{rows:[]})}function C(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(_(e),!a){var n=u(t,o.DATASOURCE);if(n)return n.head&&e.form.setAllFormValue(d({},o.CARD.form_id,n.head[o.CARD.form_id])),n.body&&e.cardTable.setTableData(o.CARD.table_code,n.body[o.CARD.table_code]),void b(e)}(0,r.ajax)({url:o.REQUESTURL.queryCard,data:{pk:t,pagecode:o.CARD.page_code},success:function(a){var r=a.success,n=a.data;r&&(n&&n.head&&e.form.setAllFormValue(d({},o.CARD.form_id,n.head[o.CARD.form_id])),n&&n.body&&e.cardTable.setTableData(o.CARD.table_code,n.body[o.CARD.table_code]),l(o.PRIMARTKEY.head_id,t,n,o.CARD.form_id,o.DATASOURCE),b(e))},error:function(t){(0,r.toast)({color:"danger",content:t.message}),_(e),b(e)}})}},6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APPCODE="90H10225",t.MULTILANG={moduleId:"90H10225",domainName:"editrule"},t.LIST={page_title:"90H10225-000011",page_code:"90H10225_LIST",search_id:"list_query",table_id:"list_head",head_btn_code:"list_head",body_btn_code:"list_inner"},t.PRIMARTKEY={head_id:"pk_auditmasc_h",body_id:"pk_auditmasc_b",bill_no:"vbillcode"},t.CARD={page_title:"90H10225-000011",page_code:"90H10225_CARD",form_id:"card_head",table_code:"card_body",table_edit_code:"card_body_edit",table_browse_code:"card_body_browse",head_btn_code:"card_head",shoulder_btn_code:"tabs_head",body_btn_code:"tabs_body"};var r=t.DATASOURCE="tm.fmc.cost.datasource",o=(t.SEARCHCACHE={key:"tm.fmc.cost.searchCache",dataSource:r},t.base_path="/nccloud/editrule/slavetable90h10225");t.REQUESTURL={save:o+"/save.do",delete:o+"/delete.do",queryCard:o+"/querycard.do",queryList:o+"/querypage.do",queryListByPks:o+"/querypagebypk.do",toCard:"/card",toList:"/list"},t.LIST_BUTTON={create:"AddBtn",bodyUpdate:"edit",bodyDelete:"delete",refresh:"RefreshBtn"},t.CARD_BUTTON={save:"SaveBtn",saveAdd:"SaveAddBtn",cancel:"CancelBtn",create:"CreateBtn",update:"UpdateBtn",delete:"DeleteBtn",refresh:"RefreshBtn",back:"Back",expand:"expand",fold:"fold",unfold:"unfold",insertRow:"insertRow",delRow:"delRow",addRow:"addRow",deleteRow:"deleteRow"}}})});